@model SignalRSQLAdmin.Web.Areas.SignalRSQLAdmin.Models.TableModel

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "Home";
}
@Scripts.Render("~/bundles/modernizr")
@section scripts {
    <!--Script references. -->
    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.1.1.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the chat page and send messages.-->
    <script>
        $("#buttonSubmitForm").click(function () {
            alert("Handler for .click() called.");
            var jsonTable = {
                Name: "lol",
                Fields: [
                    ["name", "type"],
                    ["name2", "type2LOL"]
                ]
            };
        });
        $(function () {
            // Reference the auto-generated proxy for the hub.
            var mainHub = $.connection.mainHub;

            // Create a function that the hub can call back to display messages.
            mainHub.client.notifyCreateTableResult = function (result) {
                // Add the message to the page.
                if (result.ErrorMessage != null) {
                    $('#discussion').append("<div>" + result.ErrorMessage + "</div>");
                }
                else {
                    $('#discussion').append("<div> Action OK </div>");
                }

            };

            // Start the connection.
            $.connection.hub.start().done(function () {
                $('#discussion').click(function () {
                    // Call the Send method on the hub.
                    var fakejson = {
                        Name : "lol",
                        Fields : [
                            ["name", "type"], 
                            ["name2", "type2LOL"]
                        ]
                };
                mainHub.server.createTable( fakejson );
                });
            });
        });
        // This optional function html-encodes messages for display in the page.
        function htmlEncode(value) {
            var encodedValue = $('<div />').text(value).html();
            return encodedValue;
        }
    </script>
}
<div id="discussion">test</div>
<!-- Content Header (Page header) -->
<section class="content-header">
    <h1>
        Table 2
        <small>specifications</small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
        <li><a href="#">Tables</a></li>
        <li class="active">Table 2</li>
    </ol>
</section>
<!-- Main content -->
<section class="content">
    <div class="row">
        <div class="col-xs-12">
            <div class="box">
                <div class="box-header">
                    <h3 class="box-title">Table Structure : @Model.Name , @Model.Type</h3>
                </div><!-- /.box-header -->
                <div class="box-body table-responsive">
                    <table id="example2" class="table table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Type</th>
                                <th>Max Length</th>
                                <th>Is Null</th>
                                <th>Is Primary Key</th>
                               
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var f in Model.Fields)
                            {
                                <tr>
                                    <td>@f.Name</td>
                                    <td>@f.Type</td>
                                    <td>@f.MaxLength</td>
                                    <td>@f.isNullable</td>
                                    <td>@f.isPrimaryKey</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div><!-- /.box-body -->
            </div><!-- /.box -->
            <div class="box">
                <div class="box-header">
                    <h3 class="box-title">Table Content</h3>
                </div><!-- /.box-header -->
                <div class="box-body table-responsive">
                    <table id="example1" class="table table-bordered table-striped">
                        <thead>
                            <tr>
                                @foreach (var f in Model.Fields)
                                { 
                                    <th>@f.Name</th>
                                }
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var r in Model.FirstRows)
                            {
                                <tr>
                                    @foreach (var value in r)
                                    {
                                        <td>@value</td>
                                    }
                                </tr>
                            }
                           
                        </tbody>
                        <tfoot>
                            <tr>
                                @foreach (var f in Model.Fields)
                                {
                                    <th>@f.Name</th>
                                }
                            </tr>
                        </tfoot>
                    </table>
                </div><!-- /.box-body -->
            </div><!-- /.box -->
        </div>
    </div>
</section>